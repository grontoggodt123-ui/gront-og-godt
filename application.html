<!DOCTYPE html>
<html lang="da">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Ansøgning - Træ Knapper</title>
    <link rel="stylesheet" href="style.css">
    <script src="https://cdn.jsdelivr.net/npm/@supabase/supabase-js@2"></script>
    <script src="auth.js?v=2" defer></script>
    <style>
        .app-container {
            max-width: 600px;
            margin: 50px auto;
            background: rgba(0, 0, 0, 0.85);
            padding: 40px;
            border-radius: 20px;
            border: 4px solid #8b4513;
            color: white;
        }
        .app-container h2 {
            text-align: center;
            color: #ffd700;
            margin-bottom: 30px;
            text-transform: uppercase;
        }
        .input-group {
            margin-bottom: 20px;
        }
        .input-group label {
            display: block;
            margin-bottom: 5px;
            color: #daab47;
            font-weight: bold;
        }
        .input-group input {
            width: 100%;
            padding: 10px;
            background: #222;
            border: 1px solid #5d2e0a;
            color: white;
            border-radius: 5px;
            box-sizing: border-box;
        }
    </style>
</head>
<body>
    <header>
        <div id="userEmail" class="user-display"></div>
        <div class="button-container">
            <button class="wood-button" onclick="location.href='book.html'">Tilbage</button>
            <button class="wood-button" onclick="location.href='index.html'">Hjem</button>
        </div>
    </header>
    <main>
        <div class="app-container">
            <h2>Ansøgning</h2>
            <form id="appForm">
                <div class="input-group">
                    <label>text</label>
                    <input type="text" id="field1" required>
                </div>
                <div class="input-group">
                    <label>text</label>
                    <input type="text" id="field2" required>
                </div>
                <div class="input-group">
                    <label>text</label>
                    <input type="text" id="field3" required>
                </div>
                <div class="input-group">
                    <label>text</label>
                    <input type="text" id="field4" required>
                </div>
                <div class="input-group">
                    <label>text</label>
                    <input type="text" id="field5" required>
                </div>
                <div class="input-group">
                    <label>text</label>
                    <input type="text" id="field6" required>
                </div>
                <button type="submit" class="wood-button" style="width: 100%; margin-top: 10px;">Indsend</button>
            </form>
        </div>
    </main>
    <script>
        // Vent på at auth.js indlæser _supabase
        window.addEventListener('load', () => {
            const form = document.getElementById('appForm');
            form.addEventListener('submit', async (e) => {
                e.preventDefault();
                
                const { data: { user } } = await _supabase.auth.getUser();
                
                const applicationData = {
                    user_email: user?.email || 'Anonym',
                    field1: document.getElementById('field1').value,
                    field2: document.getElementById('field2').value,
                    field3: document.getElementById('field3').value,
                    field4: document.getElementById('field4').value,
                    field5: document.getElementById('field5').value,
                    field6: document.getElementById('field6').value
                };

                const { data, error } = await _supabase
                    .from('applications')
                    .insert([applicationData]);

                if (error) {
                    alert("Der skete en fejl: " + error.message);
                } else {
                    alert("Din ansøgning er modtaget!");
                    window.location.href = 'index.html';
                }
            });
        });
    </script>
</body>
</html>
